DROP VIEW IF EXISTS `google_sso`.`usermasterv`;

CREATE ALGORITHM=UNDEFINED DEFINER=`google_sso`@`%` SQL SECURITY DEFINER VIEW `usermasterv` AS select `a`.`userDn` AS `userDn`,`a`.`userPrincipalName` AS `userPrincipalName`,`a`.`unicodePwd` AS `unicodePwd`,`a`.`whenChanged` AS `whenChanged`,`a`.`displayName` AS `displayName`,`a`.`sn` AS `sn`,`a`.`givenName` AS `givenName`,`a`.`telephoneNumber` AS `telephoneNumber`,`a`.`mail` AS `mail`,`a`.`st` AS `st`,`a`.`l` AS `l`,`a`.`streetAddress` AS `streetAddress`,`a`.`mobile` AS `mobile`,`a`.`facsimileTelephoneNumber` AS `facsimileTelephoneNumber`,`a`.`department` AS `department`,`a`.`title` AS `title`,`a`.`pager` AS `pager`,`a`.`description` AS `description`,`a`.`physicalDeliveryOfficeName` AS `physicalDeliveryOfficeName`,`a`.`ipPhone` AS `ipPhone`,`a`.`updateType` AS `updateType`,`a`.`gappsUpdateStatus` AS `gappsUpdateStatus` from `usermaster` `A` where exists(select 1 AS `1` from `mailinglist` where ((`a`.`userDn` = `mailinglist`.`userDn`) and (`mailinglist`.`groupDn` like _utf8'CN=googleapps-on%')));

DROP VIEW IF EXISTS `google_sso`.`userview`;

CREATE ALGORITHM=UNDEFINED DEFINER=`google_sso`@`%` SQL SECURITY DEFINER VIEW `userview` AS select `a`.`userDn` AS `userDn`,`a`.`userPrincipalName` AS `userPrincipalName`,`a`.`unicodePwd` AS `unicodePwd`,`a`.`whenChanged` AS `whenChanged`,`a`.`displayName` AS `displayName`,`a`.`sn` AS `sn`,`a`.`givenName` AS `givenName`,`a`.`telephoneNumber` AS `telephoneNumber`,`a`.`mail` AS `mail`,`a`.`st` AS `st`,`a`.`l` AS `l`,`a`.`streetAddress` AS `streetAddress`,`a`.`mobile` AS `mobile`,`a`.`facsimileTelephoneNumber` AS `facsimileTelephoneNumber`,`a`.`department` AS `department`,`a`.`title` AS `title`,`a`.`pager` AS `pager`,`a`.`description` AS `description`,`a`.`physicalDeliveryOfficeName` AS `physicalDeliveryOfficeName`,`a`.`ipPhone` AS `ipPhone`,`a`.`updateType` AS `updateType`,`a`.`gappsUpdateStatus` AS `gappsUpdateStatus`,`a`.`contactUpdateStatus` AS `contactUpdateStatus` from `usermaster` `a` where exists(select 1 AS `1` from `mailinglist` where ((`a`.`userDn` = `mailinglist`.`userDn`) and (`mailinglist`.`groupDn` like _utf8'CN=googleapps-on%')));
